<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>

        <ui:composition template="app.xhtml">
            <ui:define name="contenido">
                <h:form id="form">
                    <div class="p-mx-6 p-mt-4 secondary titulo-principal">#{registrarPublicacionMB.titulo}</div>
                    <p:growl id="growl" showDetail="true" />
                    <div class="p-grid p-mx-6 p-jc-center">

                        <div class="p-col-6 ui-fluid">

                            <span class="ui-float-label p-my-3">
                                <p:inputText id="titulo" value="#{registrarPublicacionMB.publicacion.titulo}"/>
                                <p:outputLabel for="@previous" value="Título*"/>
                            </span>

                            <p:dataTable widgetVar="autorestabla" id="autores" editable="true" var="autor" value="#{registrarPublicacionMB.autores}">
                                <p:column headerText="Autores">
                                    <p:cellEditor>
                                        <f:facet name="output"><h:outputText value="#{autor.nombre}"/></f:facet>
                                        <f:facet name="input"><p:inputText value="#{autor.nombre}" style="width:100%"
                                                                           label="Nombre"/></f:facet>
                                    </p:cellEditor>
                                </p:column>
                                <p:column style="width:6rem">
                                    <p:rowEditor/>
                                </p:column>

                            </p:dataTable>

                            <p:commandButton 
                                class="p-my-3"
                                value="Agregar un Autor" process="@this" update=":form:autores"
                                action="#{registrarPublicacionMB.onAddAutor()}" />
                            <!-- oncomplete="PF('autorestabla').addRow();" -->
                            <p:commandButton 
                                class="p-my-3"
                                value="Eliminar un autor"  
                                styleClass="ui-button-outlined ui-button-danger"
                                process="@this" 
                                update=":form:autores"
                                action="#{registrarPublicacionMB.onDeleteAutores()}" />


                            <span class="ui-float-label p-my-3">
                                <p:inputText type="number" id="anio" value="#{registrarPublicacionMB.publicacion.anio}" />
                                <p:outputLabel for="@previous" value="año*"/>
                            </span>

                            <span class="ui-float-label p-my-3">
                                <p:inputText id="tipoPublicacion"  value="#{registrarPublicacionMB.publicacion.tipoPublicacion}"/>
                                <p:outputLabel for="@previous" value="Tipo de publicación*"/>
                            </span>

                            <span class="ui-float-label p-my-3">
                                <p:inputText id="fuente"  value="#{registrarPublicacionMB.publicacion.fuente}"/>
                                <p:outputLabel for="@previous" value="Fuente*"/>
                            </span>

                            <span class="ui-float-label p-my-3">
                                <p:inputText type="number" id="citas"  value="#{registrarPublicacionMB.publicacion.citasRecibidas}"/>
                                <p:outputLabel for="@previous" value="Citas*"/>
                            </span>

                            <span class="ui-float-label p-my-3">
                                <p:inputTextarea maxlength="299" id="resumen" value="#{registrarPublicacionMB.publicacion.resumen}"/>
                                <p:outputLabel for="@previous" value="Resumen*"/>
                            </span>

                            <p:divider/>
                            <p>Hallazgo</p>
                            <span class="ui-float-label p-my-3">
                                <p:inputText id="objetivo"  value="#{registrarPublicacionMB.hallazgo.objetivo}"/>
                                <p:outputLabel for="@previous" value="Objetivo*"/>
                            </span>

                            <p:divider/>
                            <p>Datos</p>
                            <h:panelGroup id="datosform">


                                <ui:repeat  value="#{registrarPublicacionMB.datos}" var="dato" varStatus="datoStatus">

                                    <div class="p-my-5">

                                        <span class="ui-float-label p-my-3">
                                            <p:inputText id="#{datoStatus.index}titulo"  value="#{dato.titulo}"/>
                                            <p:outputLabel for="@previous" value="Titulo"/>
                                        </span>
                                        <span class="ui-float-label p-my-3">
                                            <p:inputText id="#{datoStatus.index}descripcion"  value="#{dato.descripcion}"/>
                                            <p:outputLabel for="@previous" value="Descripcion"/>
                                        </span>
                                        <p:divider/>
                                    </div>

                                </ui:repeat>
                            </h:panelGroup>

                            <p:commandButton actionListener="#{registrarPublicacionMB.agregarDato()}"
                                             value="Agregar un dato" 
                                             styleClass="bgsecondary" 
                                             update="datosform"
                                             class="bgsecondary border-secondary p-mb-3" 
                                             process="@this"
                                             />
                            <p:commandButton actionListener="#{registrarPublicacionMB.clear()}"
                                             value="Limpiar formulario" 
                                             styleClass="bgsecondary" 
                                             update="datosform"
                                             class="bgsecondary border-secondary p-mb-3" 
                                             process="@this"
                                             />




                            <p:commandButton action="#{registrarPublicacionMB.registrar()}"
                                             id="s" 
                                             value="Registrar publicación" 
                                             styleClass="bgprimary" 
                                             update="growl" 
                                             class="bgprimary border-primary" 
                                             />
                        </div>
                    </div>
                </h:form>
            </ui:define>
        </ui:composition>
    </h:body>
</html>

